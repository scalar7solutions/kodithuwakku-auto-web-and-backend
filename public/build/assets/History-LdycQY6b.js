import{d as l,J as r,e as m,o as h,w as i,f as t,g as b}from"./index-CgzAhKMx.js";import{A as p}from"./AppLayout-Crsfd-lO.js";import{D as f}from"./DataTable-D_0Rc19t.js";import{_ as k}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./index-CRUnqYQo.js";const g={components:{Link:l.Link,AppLayout:p,DataTable:f},data(){return{columns:[{data:"check",name:"check",orderable:!1,searchable:!1},{data:"customer",name:"customer",orderable:!0,searchable:!0},{data:"mobile",name:"mobile",orderable:!1,searchable:!0},{data:"services",name:"services",orderable:!1,searchable:!0},{data:"date_time",name:"date_time",orderable:!1,searchable:!0},{data:"total",name:"total",orderable:!0},{data:"status",name:"status",orderable:!0},{data:"action",name:"action",orderable:!0}],columnDefs:[{className:"text-center",targets:[]}],order:[[1,"desc"]],form:l.useForm({id:"",status:""})}},props:{customer:Object},mounted(){$("#mytable tbody").on("click","tr .action_delete",s=>{const e=$(s.target).data("item-id");this.selectedRows=[],this.getSelectedItems(e)}),$("#mytable tbody").on("click","tr .action_edit",s=>{const e=$(s.target).data("item-id");this.$inertia.visit(route("booking.edit",e))}),$("#mytable tbody").on("click","tr .action_status_change",s=>{const e=$(s.target).data("item-id"),o=$(s.target).data("status");this.updateStatus(e,o)}),$("#mytable tbody").on("click",".item-check input[type=checkbox]",s=>{const e=$(s.target).val();$(s.target).prop("checked")&&!this.selectedRows.includes(e)?this.getSelectedItems(e):this.removeUnselectedItem(e)})},methods:{reloadTable(){this.$refs.datatable.reloadDatatable()},getSelectedItems(s){this.selectedRows.push(s),this.selectedRows.length>0&&(this.$data.isDisabled=!1)},selectAll(s){var e=this;$(s.target).is(":checked")?($(".item-check input[type=checkbox]").prop("checked",!0),$(".item-check input[type=checkbox]:checked").each(function(){e.selectedRows.includes(this.value)||e.getSelectedItems(this.value)}),this.$data.isDisabled=!1):($(".item-check input[type=checkbox]").prop("checked",!1),$(".item-check input[type=checkbox]").each(function(){e.selectedRows.includes(this.value)&&e.removeUnselectedItem(this.value)}),this.$data.isDisabled=!0)},removeUnselectedItem(s){this.selectedRows=this.selectedRows.filter(function(e){return e!=s}),this.selectedRows.length<=0&&($("#selectAll").prop("checked",!1),this.$data.isDisabled=!0)},updateStatus(s,e){this.form.id=s,this.form.status=e,this.form.put(route("booking.change.status"),{preserveScroll:!0,onSuccess:()=>{this.form.reset(),this.reloadTable(),this.$root.showMessage("success",'<span class="text-success">Success</span><br/>',"Staus Updated Successfully! ")},onError:()=>{this.$root.showMessage("error",'<span class="text-danger">Error</span><br>',"Something went wrong! ")}})},deleteSelectedItems(){this.form.transform(s=>({...s,ids:[...this.selectedRows]})).post(route("booking.delete"),{onSuccess:()=>{this.resetForm(),this.reloadTable(),this.$root.showMessage("success",'<span class="text-success">Success</span><br/>',"A Record Was Created Successfully! ")},onError:()=>{this.$root.showMessage("error",'<span class="text-danger">Error</span><br>',"Something went wrong! ")},onFinish:()=>{$("#deleteConfirm").modal("hide"),this.resetForm()}})},resetForm(){this.form.reset("id","status")}}},v={class:"row"},w={class:"col-md-12"},y={class:"card mb-4"},x={class:"card-body"},S={class:"container mt-5"},_={class:"tab-content border rounded-3 border-main p-3",id:"pills-tabContent"},D={class:"tab-pane fade show active pb-5 px-2",id:"pills-home",role:"tabpanel","aria-labelledby":"pills-home-tab"},A={width:"10%"},R={class:"custom-control custom-checkbox"};function C(s,e,o,I,a,c){const d=r("data-table"),n=r("AppLayout");return h(),m(n,null,{default:i(()=>[t("div",v,[t("div",w,[t("div",y,[e[10]||(e[10]=t("div",{class:"card-header pb-0"},[t("h5",null,"Customer history"),t("p",null,"View customer activities.")],-1)),t("div",x,[t("div",S,[e[9]||(e[9]=t("ul",{class:"nav nav-pills mb-3 border-bottom border-2 mb-5",id:"pills-tab",role:"tablist"},[t("li",{class:"nav-item px-5",role:"presentation"},[t("button",{class:"nav-link text-main fw-semibold active position-relative",id:"pills-home-tab","data-bs-toggle":"pill","data-bs-target":"#pills-home",type:"button",role:"tab","aria-controls":"pills-home","aria-selected":"true"},"Bookings")])],-1)),t("div",_,[t("div",D,[b(d,{ref:"datatable",id:"mytable",url:s.route("customer.getBookings",{id:o.customer.id}),columns:a.columns,columnDefs:a.columnDefs},{header:i(()=>[t("tr",null,[t("th",A,[t("div",R,[t("input",{type:"checkbox",class:"form-check-input",id:"selectAll",onClick:e[0]||(e[0]=u=>c.selectAll(u))}),e[1]||(e[1]=t("label",{class:"form-check-label",for:"selectAll"},null,-1))])]),e[2]||(e[2]=t("th",null,"Customer Name",-1)),e[3]||(e[3]=t("th",null,"Mobile",-1)),e[4]||(e[4]=t("th",null,"Services",-1)),e[5]||(e[5]=t("th",null,"Date & Time",-1)),e[6]||(e[6]=t("th",null,"Total",-1)),e[7]||(e[7]=t("th",null,"Status",-1)),e[8]||(e[8]=t("th",null,"Action",-1))])]),_:1},8,["url","columns","columnDefs"])])])])])])])])]),_:1})}const M=k(g,[["render",C]]);export{M as default};
